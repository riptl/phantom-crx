(function(define){var __define;"function"==typeof define&&define.amd&&(__define=define,define=null);
function e(e){return e&&e.__esModule?e.default:e}function t(e,t,n,a){Object.defineProperty(e,t,{get:n,set:a,enumerable:!0,configurable:!0})}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},o={},r=n.parcelRequirea886;null==r&&((r=function(e){if(e in a)return a[e].exports;if(e in o){var t=o[e];delete o[e];var n={id:e,exports:{}};return a[e]=n,t.call(n.exports,n,n.exports),n.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){o[e]=t},n.parcelRequirea886=r);var i=r("aZikt"),s=r("ihAua"),l=r("eLyRJ"),c=r("HEK4k"),u=r("ci2Mj"),d=r("5cKs6"),p=r("iyOkC"),m=r("4yWCU");r("6CHoY");var g={};t(g,"BackgroundConnectionProvider",(function(){return E}),(function(e){return E=e})),t(g,"useIncomingBackgroundRequest",(function(){return b}),(function(e){return b=e})),t(g,"usePostOutgoingBackgroundResponse",(function(){return x}),(function(e){return x=e}));i=r("aZikt");var f=r("e5x4G"),v=r("6oEu9"),y=(p=r("iyOkC"),function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{l(a.next(e))}catch(e){r(e)}}function s(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((a=a.apply(e,t||[])).next())}))});const h={isConnected:!1,lastMessage:null,postMessage:v.NOOP},T=e(i).createContext(h),E=({children:t})=>{const[n,a,o]=function(){const[e,t]=i.useState(null),[n,a]=i.useState(null);i.useEffect((()=>{let e;return(()=>y(this,void 0,void 0,(function*(){const n=`notification/${(yield p.getCurrentWindowAsync()).id}`;e=f.browser.runtime.connect({name:n}),t(e),e.onMessage.addListener((e=>{a(e)})),e.onDisconnect.addListener((()=>{t(null)}))})))(),()=>{null==e||e.disconnect()}}),[]);const o=i.useCallback((t=>{e&&e.postMessage(t)}),[e]);return[!!e,n,o]}();return e(i).createElement(T.Provider,{value:{isConnected:n,lastMessage:a,postMessage:o}},t)};function A(){const e=i.useContext(T);if(!e)throw new Error("Missing background connection context");return e}function b(){const{lastMessage:e}=A();return e&&"string"==typeof e.origin&&e.origin&&e.req&&"string"==typeof e.req.method&&e.req.method?e:null}function x(){const e=b(),{postMessage:t}=A();return i.useCallback((n=>{if(!e)throw new Error("No request received from the background yet");if(e.req.id!==n.id)throw new Error(`Request id: ${e.req.id} does not match response id: ${n.id}`);t(n)}),[e,t])}var k=r("6rMcH"),S=r("82Ilk"),w=r("9ZliH"),C=r("5DQqc"),M=r("eeuNW"),P=r("g9lcT"),R=r("h5G75"),I=r("6mzlH"),O=r("jSC0s"),B=r("cjUNA"),q=(i=r("aZikt"),r("hHMPk")),F=r("8C6BZ"),H=r("lwple"),L=(l=r("eLyRJ"),S=r("82Ilk"),i=r("aZikt"),q=r("hHMPk"),r("7Qmuu")),D=r("cFuyE"),N=r("hJDxl"),j=r("bJYWD"),W=r("9AO5f"),K=r("aADTv"),U=r("lSpdH"),z=r("g7X40");const $=q.default.div`
  border-top: 1px solid #333333;
  border-bottom: 1px solid #333333;
  width: 100%;
  display: flex;
  padding: 10px 5px;
`,Q=q.default.div`
  > * {
    margin: 18px 0px;
  }
`,J=q.default.div`
  display: flex;
  flex-direction: row;
  align-items: center;
  > * {
    margin: 0px ${e=>e.spacing}px;
    text-align: left;
  }
`,Z=({tabId:t,origin:n,confirmApproval:a,denyApproval:o})=>{const{t:r}=L.useTranslation();return e(i).createElement(j.Container,null,e(i).createElement(W.AccountHeader,{lastChild:e(i).createElement("div",null),walletMenuShowOnlyAccounts:!0}),e(i).createElement(j.Body,null,e(i).createElement(j.TopGroup,null,e(i).createElement(U.TabIconHeader,{tabId:t,secondaryText:D.removeWebPrefixes(n)})),e(i).createElement($,null,e(i).createElement(Q,null,e(i).createElement(J,{spacing:8},e(i).createElement(z.Text,{size:14,color:"#777777",lineHeight:16.94,weight:500},r("notificationApplicationApprovalPermissionsPrimary"))),e(i).createElement(J,{spacing:8},e(i).createElement(N.CheckmarkIcon,{fill:"#21E56F"}),e(i).createElement(z.Text,{size:14,lineHeight:17},r("notificationApplicationApprovalPermissionsViewWalletActivity"))),e(i).createElement(J,{spacing:8},e(i).createElement(N.CheckmarkIcon,{fill:"#21E56F"}),e(i).createElement(z.Text,{size:14,lineHeight:17},r("notificationApplicationApprovalPermissionsTransactionApproval"))))),e(i).createElement(j.BottomGroup,null,e(i).createElement(J,{spacing:4},e(i).createElement(z.Text,{size:14,lineHeight:17,color:"#777"},r("notificationApplicationApprovalConnectDisclaimer"))))),e(i).createElement(j.Footer,{plain:!0},e(i).createElement(K.ButtonPair,{primaryText:r("notificationApplicationApprovalActionButtonConnect"),secondaryText:r("notificationApplicationApprovalActionButtonCancel"),onPrimaryClicked:()=>a(n),onSecondaryClicked:()=>o(n)})))};var _=r("6oQjh"),G=r("iO2dB"),V=r("9OxTN"),Y=r("lPkGw");const X=q.default.div`
  display: flex;
  flex-direction: column;
  height: 100%;
  justify-content: center;
  align-items: center;
`,ee=({tabId:t,origin:n,requestId:a})=>{var o;const{accountClient:r}=S.useSelectedSolanaAccount(),s=r.publicKey.toString(),c=g.usePostOutgoingBackgroundResponse(),[u,d,p]=_.useStorage(H.StorageKeys.TrustedApplicationsByOwnerBrowser,{}),m=null!==(o=u[s])&&void 0!==o?o:{},f=void 0!==m[n],[v,y]=e(i).useState(!1),[h,T]=e(i).useState(!1),E=t=>{const n=e(B)(m);n[t]=!0,F.analytics.capture("connectionConfirm",{data:{origin:t}}),p(Object.assign(Object.assign({},u),{[s]:n}))},A=()=>{F.analytics.capture("connectionDeny",{data:{origin:n}});const e=l.createJsonRpcErrorResponse(a,l.RpcErrorCode.UserRejectedRequest);c(e)};if(i.useEffect((()=>{f?(()=>{const e={publicKey:s},t=l.createJsonRpcResponse(a,e);c(t)})():V.detectPhishing(n).then((e=>{T(e.result),y(!0)})).catch((()=>{y(!0)}))}),[f]),f)return null;return d||!v?e(i).createElement(X,null,e(i).createElement(Y.Spinner,null)):h?e(i).createElement(G.BlocklistConnectRequest,{tabId:t,origin:n,confirmApproval:E,denyApproval:A}):e(i).createElement(Z,{tabId:t,origin:n,confirmApproval:E,denyApproval:A})};var te={};t(te,"SignatureRequest",(function(){return ht}),(function(e){return ht=e}));i=r("aZikt"),q=r("hHMPk"),L=r("7Qmuu");var ne=r("bgp3N"),ae=(F=r("8C6BZ"),l=r("eLyRJ"),c=r("HEK4k"),H=r("lwple"),r("7eQt4")),oe=r("7Lj33"),re=(S=r("82Ilk"),w=r("9ZliH"),k=r("6rMcH"),i=r("aZikt"),F=r("8C6BZ"),{});t(re,"useFetchScannedTransaction",(function(){return ue}),(function(e){return ue=e}));i=r("aZikt"),v=r("6oEu9");var ie=r("j5GoN"),se=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{l(a.next(e))}catch(e){r(e)}}function s(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((a=a.apply(e,t||[])).next())}))};const le=new Error("Ninja API key missing");var ce;!function(e){e.ChecksPassed="CHECKS_PASSED",e.KnownMalicious="KNOWN_MALICIOUS",e.SuspectedMalicious="SUSPECTED_MALICIOUS"}(ce||(ce={}));const ue=(e,t)=>{const[n,a]=i.useState({error:null,isLoading:!0});if(i.useEffect((()=>{se(void 0,void 0,void 0,(function*(){try{const n=new AbortController,o=n.signal;setTimeout((()=>{n.abort()}),3e3);const r=new Headers;if(void 0===v.NINJA_SECURITY_API_KEY)return void a({error:le,isLoading:!1});r.append("X-NINJA-API-Key",v.NINJA_SECURITY_API_KEY),r.append("Content-Type","application/json");const i={transactions:e,metadata:{origin:t}},s={method:"POST",headers:r,body:JSON.stringify(i)},l=new Request("https://api.ninja.security/solana/v0/mainnet/scan/transactions",s),c=yield fetch(l,{signal:o});if(c.ok){const e=yield c.json();if(void 0===e.status||![ce.ChecksPassed,ce.KnownMalicious,ce.SuspectedMalicious].includes(e.status))return void a({error:new Error("Response missing valid TxnScanStatus"),isLoading:!1});const t=e.status===ce.KnownMalicious,n=e.status===ce.SuspectedMalicious;a({error:null,isTxnKnownMalicious:t,isTxnSuspectedMalicious:n,isLoading:!1})}else a({error:new Error(`Ninja API returned non-200 response: ${c.status}`),isLoading:!1})}catch(e){e.message.toLowerCase().includes("aborted")?a({error:ie.ERR_REQUEST_TIMEOUT_REACHED,isLoading:!1}):a({error:e,isLoading:!1})}}))}),[JSON.stringify(e)]),null!==n.error&&n.error===le)throw n.error;return n};ie=r("j5GoN"),ae=r("7eQt4");var de=r("fMhDQ"),pe=(q=r("hHMPk"),i=r("aZikt"),L=r("7Qmuu"),v=r("6oEu9"),r("9qtir")),me=(F=r("8C6BZ"),D=r("cFuyE"),c=r("HEK4k"),ae=r("7eQt4"),r("lzptm")),ge=r("2t1ms"),fe=(i=r("aZikt"),r("hZalX")),ve=r("ljcNr"),ye=(S=r("82Ilk"),r("jC9PB")),he={};t(he,"useFetchSimulatedTransaction",(function(){return Ee}),(function(e){return Ee=e}));ae=r("7eQt4"),c=r("HEK4k"),S=r("82Ilk"),R=r("h5G75");var Te=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{l(a.next(e))}catch(e){r(e)}}function s(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((a=a.apply(e,t||[])).next())}))};function Ee(e,t){const{accountClient:n}=S.useSelectedSolanaAccount(),a=["simulated-tx",{messages:e}],o=!!e;return R.useQuery({queryKey:a,queryFn:()=>Te(this,void 0,void 0,(function*(){const t=c.messagesToTransaction(e);t.recentBlockhash||(t.recentBlockhash=yield n.getLatestBlockhash()),t.feePayer||(t.feePayer=n.publicKey);const a=c.getAccountsFromTransaction(t).filter((e=>!/1111111111111111/.test(e.toString()))),o=(yield n.simulateTransaction(t,a)).value.accounts;return new Map(ae.zip(a.map((e=>e.toString())),o))})),enabled:o,refetchInterval:t})}var Ae=r("dkOkP").Buffer;var be=r("8udvA"),xe={};t(xe,"useTokenMetasForMints",(function(){return Ce}),(function(e){return Ce=e}));var ke=r("lxqKj"),Se=r("9MFgk"),we=(oe=r("7Lj33"),D=r("cFuyE"),me=r("lzptm"),de=r("fMhDQ"),function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{l(a.next(e))}catch(e){r(e)}}function s(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((a=a.apply(e,t||[])).next())}))});const Ce=e=>{var t;const n=me.useFetchTokenMetas().data,a=new Map(null==n?void 0:n.map((e=>[e.address,e]))),o=null===(t=de.useFetchConnection())||void 0===t?void 0:t.data,r=null==o?void 0:o.connection;return ke.useAsync((()=>we(void 0,void 0,void 0,(function*(){var t,n,o;if(!e.length||!r)return{};const i={},s=[];for(const t of e){const e=a.get(t);e?i[t]=e:s.push(t)}if(s.length){const e=yield oe.fetchMintInfos(s,r),a=(yield Se.fetchCollectibleMetadata(s,r)).reduce(((e,t)=>(e[t.mint.toString()]=t,e)),{});for(const r of s){const s=e[r],l=a[r];if(s){let e;l&&(e=yield Se.fetchUriData(l.data.uri,r)),i[r]={decimals:s.decimals,address:r,symbol:null!==(t=null==l?void 0:l.data.symbol)&&void 0!==t?t:D.formatAddressShort(r),name:null!==(o=null!==(n=null==e?void 0:e.name)&&void 0!==n?n:null==l?void 0:l.data.name)&&void 0!==o?o:"Unknown",isCollectible:!!l&&!!l.data.uri}}}}return i}))),[e.length])};j=r("bJYWD"),W=r("9AO5f"),K=r("aADTv"),U=r("lSpdH");var Me=r("eopQk");q=r("hHMPk"),z=r("g7X40");const Pe=q.default.section`
  background: #2a2a2a;
  border-radius: 6px;
  margin-bottom: 10px;
`,Re=q.default.div`
  padding-top: 0px;
  padding-bottom: 12px;
  padding-left: 18px;
  padding-right: 18px;
  border-top: 1px solid #222222;
  > * {
    margin-top: 12px;
  }
`,Ie=(q.default.div`
  padding: 12px 18px;
  display: flex;
  flex-direction: row;
  justify-content: space-between;
`,q.default(z.Text).attrs({textAlign:"left",size:14,weight:500,lineHeight:17})``,q.default.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  > * {
    display: flex;
    align-items: center;
  }
`);z=r("g7X40");var Oe={};t(Oe,"TransactionInstructionRows",(function(){return Ne}),(function(e){return Ne=e})),t(Oe,"SignMessageInstructionRow",(function(){return je}),(function(e){return je=e})),t(Oe,"RowCard",(function(){return Ze}),(function(e){return Ze=e}));q=r("hHMPk"),i=r("aZikt"),F=r("8C6BZ"),D=r("cFuyE"),S=r("82Ilk"),i=r("aZikt");Me=r("eopQk"),z=r("g7X40");var Be=r("k7WoY"),qe=r("k8hDx"),Fe=(oe=r("7Lj33"),de=r("fMhDQ"),r("9BE2q")),He=r("dkOkP").Buffer,Le=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{l(a.next(e))}catch(e){r(e)}}function s(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((a=a.apply(e,t||[])).next())}))};const De=[],Ne=({messages:t})=>{const{accountClient:n}=S.useSelectedSolanaAccount(),a=i.useCallback((()=>Le(void 0,void 0,void 0,(function*(){const e=(yield Promise.all(t.map((e=>n.decodeMessageAsync(e))))).filter((e=>void 0!==e));return e.flat().forEach((e=>{e&&F.analytics.capture("transactionInstructionApproval",{data:{origin:origin,type:e.type}})})),e}))),[t]),[o,r,s]=function(t,n){const[a,o]=e(i).useState({value:n,error:null,isPending:!0});e(i).useEffect((()=>{t().then((e=>o({value:e,error:null,isPending:!1}))).catch((e=>o({value:n,error:e.toString(),isPending:!1})))}),[t,n]);const{value:r,error:s,isPending:l}=a;return[r,s,l]}(a,De),l=o.flat();return e(i).createElement(Me.LoadingContent,{isLoading:s},l.map(((t,n)=>e(i).createElement(Je,{key:n,decodedMessage:t}))))},je=({message:t,display:n="utf8"})=>{let a;if("hex"===n)a=`0x${He.from(t).toString("hex")}`;else a=(new TextDecoder).decode(t);return e(i).createElement(We,null,e(i).createElement(Ke,null,e(i).createElement(z.Text,{textAlign:"left",size:14,weight:600,lineHeight:17},"Sign message"),e(i).createElement(Be.Info,{tooltipAlignment:"bottomRight",info:e(i).createElement(qe.TooltipContent,{paddingLeft:10,paddingRight:10},e(i).createElement(qe.TooltipText,null,"Make sure you understand what you are signing and trust the application that is requesting this."))})),e(i).createElement(Ue,null,e(i).createElement(ze,null,e(i).createElement(z.Text,{size:14,weight:500,lineHeight:17,whiteSpace:"pre-line",wordBreak:"break-all",textAlign:"left",color:"#777"},a))))},We=q.default.section`
  background: #2a2a2a;
  border-radius: 6px;
  margin-bottom: 10px;
`,Ke=q.default.div`
  padding: 12px 18px;
  display: flex;
  flex-direction: row;
  justify-content: space-between;
`,Ue=q.default.div`
  padding-top: 0px;
  padding-bottom: 12px;
  padding-left: 18px;
  padding-right: 18px;
  border-top: 1px solid #222222;
  > * {
    margin-top: 12px;
  }
`,ze=q.default.div`
  display: flex;
  justify-content: space-between;
`,$e=q.default.a.attrs({target:"_blank",rel:"noopener noreferrer"})`
  text-decoration: none;
  cursor: pointer;
`,Qe=({condition:e,wrapper:t,children:n})=>e?t(n):n,Je=({decodedMessage:t})=>{var n;const a=null===(n=de.useFetchConnection())||void 0===n?void 0:n.data,o=null==a?void 0:a.cluster,{preferredExplorer:r}=Fe.usePreferredExplorer(),s=i.useMemo((()=>Ge(t)),[t]),l=i.useMemo((()=>tt(t,r.type,o)),[t,o,r]);return e(i).createElement(Ze,{title:s,rowItems:l})},Ze=({title:t,rowItems:n,emptyDescription:a,info:o})=>e(i).createElement(We,null,e(i).createElement(Ke,null,e(i).createElement(z.Text,{textAlign:"left",size:14,weight:500,lineHeight:17},t),o&&e(i).createElement(Be.Info,{info:o})),e(i).createElement(Ue,null,n.map((({keyText:t,valueText:n,valueColor:a,link:o})=>e(i).createElement(ze,{key:t||n},t&&e(i).createElement(z.Text,{size:14,lineHeight:17,color:"#777777"},t),e(i).createElement(Qe,{condition:o,wrapper:t=>e(i).createElement($e,{href:o},t)},e(i).createElement(z.Text,{size:14,weight:500,lineHeight:17,color:a,whiteSpace:t?"normal":"pre-line",wordBreak:"break-word"},n))))),0===n.length&&e(i).createElement(ze,null,e(i).createElement(z.Text,{size:14,weight:400,lineHeight:17,whiteSpace:"normal"},a)))),_e={cancelOrder:"Cancel order",cancelOrderV2:"Cancel order",newOrder:"Place order",newOrderV3:"Place order",settleFunds:"Settle funds",matchOrders:"Match orders",initializeMint:"Initialize mint",initializeAccount:"Initialize account",transfer:"Transfer",approve:"Approve",mintTo:"Mint to",closeAccount:"Close account",systemCreate:"Create account",systemTransfer:"Transfer SOL",createAssociatedTokenAccount:"Create token account",signMessage:"Sign Message",unknown:"Unknown"},Ge=e=>{var t;const{type:n}=e;return null!==(t=_e[n])&&void 0!==t?t:n},Ve={side:{label:"Side",isAddress:!1},orderId:{label:"Order Id",isAddress:!1},limit:{label:"Limit",isAddress:!1},basePubkey:{label:"Base wallet",isAddress:!0},quotePubkey:{label:"Quote wallet",isAddress:!0}},Ye={amount:{label:"Amount",isAddress:!1},accountPubkey:{label:"Account",isAddress:!0},mintPubkey:{label:"Mint",isAddress:!0},sourcePubkey:{label:"Source",isAddress:!0},destinationPubkey:{label:"Destination",isAddress:!0},ownerPubkey:{label:"Owner",isAddress:!0}},Xe={toPubkey:{label:"To",isAddress:!0},accountPubkey:{label:"Account",isAddress:!0},basePubkey:{label:"Base",isAddress:!0},seed:{label:"Seed",isAddress:!1},noncePubkey:{label:"Nonce",isAddress:!0},authorizedPubkey:{label:"Authorized",isAddress:!0},newAuthorizedPubkey:{label:"New authorized",isAddress:!0},newAccountPubkey:{label:"New account",isAddress:!0},amount:{label:"Amount",isAddress:!1},lamports:{label:"Amount",isAddress:!1}},et=(e,t)=>{const{market:n,marketInfo:a,data:o}=e,r=[];a&&r.push({keyText:"Market",valueText:a.name});const{side:i,limitPrice:s,maxQuantity:l,maxBaseQuantity:c,orderType:u,ownerPubkey:d}=o;r.push({keyText:"Side",valueText:i.charAt(0).toUpperCase()+i.slice(1)}),r.push({keyText:"Price",valueText:(null==n?void 0:n.priceLotsToNumber(s))||""+s});const p=t?c:l;return r.push({keyText:"Quantity",valueText:(null==n?void 0:n.baseSizeLotsToNumber(p))||""+p}),r.push({keyText:"Type",valueText:u.charAt(0).toUpperCase()+u.slice(1)}),r.push({keyText:"Owner",valueText:at(d)}),r},tt=(e,t,n)=>{switch(e.type){case"cancelOrder":case"cancelOrderV2":case"matchOrders":case"settleFunds":return((e,t,n)=>{const a=[];return e.marketInfo&&a.push({keyText:"Market",valueText:e.marketInfo.name}),nt(a,e.data,Ve,t,n),a})(e,t,n);case"closeAccount":case"initializeAccount":case"transfer":case"approve":case"mintTo":return((e,t,n)=>{const a=[];return nt(a,e.data,Ye,t,n),a})(e,t,n);case"systemCreate":case"systemTransfer":return((e,t,n)=>{const a=[];return nt(a,e.data,Xe,t,n),a})(e,t,n);case"newOrder":return et(e,!1);case"newOrderV3":return et(e,!0);case"unknown":case"createAssociatedTokenAccount":return((e,t,n)=>{const a=e.rawData,o=a.length>20?D.formatHashMedium(a,10):a,r=e.data.programId,i=n?oe.generateAddressExplorerUrl(r.toString(),n,t):void 0;return o?[{keyText:"Program Id",valueText:at(r),valueColor:"#8A81F8",link:i},{keyText:"Data",valueText:o}]:[{keyText:"Program Id",valueText:at(r),valueColor:"#8A81F8",link:i}]})(e,t,n);default:return[]}},nt=(e,t,n,a,o)=>{Object.entries(t).forEach((([t,r])=>{const i=n[t];if(i){const{label:n,isAddress:s}=i,l=n;let c,u,d="";s?(d=at(r),o&&(c=oe.generateAddressExplorerUrl(r.toString(),o,a),u="#8A81F8")):"lamports"===t?d=`${D.formatTokenAmount(D.lamportsToSolana(Number(r)))} SOL`:"function"==typeof r.toString()?d=r.toString():"string"==typeof r&&(d=r),e.push({keyText:l,valueText:d,valueColor:u,link:c})}}))},at=e=>{const t=e.toString();return D.formatHashMedium(t)};qe=r("k8hDx"),Be=r("k7WoY");var ot=r("2MtnF");const rt=q.default(Me.LoadingContent)`
  height: 150px;
`,it=q.default(z.Text)`
  color: ${e=>e.isKnownMalicious?ct:lt};
`,st=q.default.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 12px 20px;
  width: 100%;
  height: 48px;
  border-width: 1px;
  border-style: solid;
  border-color: ${e=>e.isKnownMalicious?ct:lt};
  border-radius: 6px;
  margin-bottom: 10px;
`,lt="#FFDC62",ct="#EB3742",ut=({tabId:t,origin:n,messages:a,confirmApproval:o,denyApproval:r,transactionName:s,isTxnKnownMalicious:l,isTxnSuspectedMalicious:u})=>{var d;const{t:p}=L.useTranslation(),m=be.useGetNetworkFee()*c.getRequiredSignatures(a),[g,f]=i.useState(!1),y=me.useFetchSolanaBalance(),h=y.data,T=me.useFetchAssetsWithAccount(),E=T.data,A=ge.useFetchCollectibles(),b=A.data,x=i.useMemo((()=>{if(!E||!b)return ae.objectArrayToMap([],"account");const e=[...E,...b];return ae.objectArrayToMap(e,"account")}),[E,b]),k=!y.isFetched||!T.isFetched||!A.isFetched,w=((e,t=!1)=>{const n=he.useFetchSimulatedTransaction(e,t),a=n.error,{accountClient:o}=S.useSelectedSolanaAccount(),r=n.data,s=i.useMemo((()=>{const e=new Map;if(r){for(const[t,n]of r)if(n&&n.data&&n.owner.toString()===fe.TOKEN_PROGRAM_ID.toString()){const[a]=n.data;try{const n=ve.deserializeTokenAccount(Ae.from(a,"base64"));n.owner===o.publicKey.toString()&&e.set(t,n)}catch(e){}}return e}}),[r]);return{balances:i.useMemo((()=>{const e={};if(!r||!s)return;const t=o.publicKey.toString(),n=null==r?void 0:r.get(t);n&&(e[t]={amount:new ye.BigNumber(n.lamports)});for(const[n,a]of s)a.owner===t&&(e[n]={mint:a.mint,amount:a.amount,delegate:a.delegate});return e}),[r,s]),error:a}})(a,5e3),C=Object.values(null!==(d=w.balances)&&void 0!==d?d:{}).map((e=>e.mint)).filter((e=>!!e)),M=xe.useTokenMetasForMints(C),P=i.useMemo((()=>{var e;const{balances:t}=w;if(!t||k)return;const n=[];for(const[a,o]of Object.entries(t)){if(void 0===o.mint&&h){const e=o.amount.minus(h),t=D.lamportsToSolana(e.toNumber())+m;if(0!==t){const a=D.formatTokenAmount(Math.abs(t));n.push({keyText:v.SOLANA.symbol,valueText:e.isNegative()?`-${a} ${v.SOLANA.symbol}`:`+${a} ${v.SOLANA.symbol}`,valueColor:e.isNegative()?"#EB3742":"#21E56F"})}continue}const t=x[a],r=o.mint;if(t){const a=o.amount.minus(t.baseBalance),i=D.amountToUiAmount(a.abs(),t.decimals),s=D.formatTokenAmount(Math.abs(i));if("fungible"===t.type){const o=null!==(e=null==t?void 0:t.symbol)&&void 0!==e?e:D.formatAddressShort(null!=r?r:t.address);0!==i&&n.push({keyText:o,valueText:a.isNegative()?`-${s} ${o}`:`+${s} ${o}`,valueColor:a.isNegative()?"#EB3742":"#21E56F"})}else if("collectible"===t.type){const e="NFT";if(0!==i){const o="1"===s?"":`(${s})`;n.push({keyText:e,valueText:a.isNegative()?`-${t.name} ${o}`:`+${t.name} ${o}`})}}}else if(M.value&&r){const e=M.value[r];if(e){const t=D.amountToUiAmount(o.amount.toNumber(),e.decimals);if(0!==t){const a=D.formatTokenAmount(t),o="1"===a?"":`(${a})`;n.push({keyText:e.isCollectible?"NFT":e.symbol,valueText:e.isCollectible?`+${e.name} ${o}`:`+${a} ${e.symbol}`,valueColor:e.isCollectible?void 0:"#21E56F"})}}}}return n}),[w,x,h,m,M,k]),R=e(i).createElement(qe.TooltipContent,{paddingLeft:10,paddingRight:10},e(i).createElement(qe.TooltipText,null,p("notificationTransactionApprovalEstimatesBasedOnSimulations")));let I=p("notificationTransactionApprovalUnableToFetchBalanceChanges");w.error instanceof pe.TransactionSimulationError&&(I=p("notificationTransactionApprovalTransactionMayFailToConfirm"));const O=i.useMemo((()=>{const e=c.canEvadeTransactionSimulation(a);return e&&F.analytics.capture("transactionCanEvadeSimulation",{data:{messages:a.join("|")}}),e}),[a]);return O&&(I=p("notificationTransactionApprovalSignUnableToSimulate")),e(i).createElement(j.Container,null,e(i).createElement(W.AccountHeader,{firstChild:e(i).createElement("div",null),lastChild:e(i).createElement("div",null)}),e(i).createElement(j.Body,null,e(i).createElement(j.Icon,null,e(i).createElement(U.TabIconHeader,{tabId:t,primaryText:s,secondaryText:D.removeWebPrefixes(n)})),e(i).createElement(rt,{isLoading:void 0===P&&!w.error,showingDelayMs:0},(l||u)&&e(i).createElement(st,{isKnownMalicious:l},e(i).createElement(it,{size:14,weight:500,lineHeight:19.6,isKnownMalicious:l},p(l?"notificationTransactionApprovalKnownMalicious":"notificationTransactionApprovalSuspectedMalicious"))),w.error||O?e(i).createElement(Oe.RowCard,{title:p("notificationTransactionApprovalEstimatedBalanceChanges"),rowItems:[{valueText:I,valueColor:ct}],info:R}):e(i).createElement(Oe.RowCard,{title:p("notificationTransactionApprovalEstimatedBalanceChanges"),rowItems:P,emptyDescription:p("notificationTransactionApprovalNoBalanceChanges"),info:R}),e(i).createElement(Pe,null,e(i).createElement(Re,null,e(i).createElement(Ie,null,e(i).createElement(z.Text,{size:14,lineHeight:17,textAlign:"left",color:"#777",style:{gap:10,marginLeft:"-8px"}},e(i).createElement(Be.Info,{info:e(i).createElement(qe.TooltipContent,{paddingLeft:10,paddingRight:10},e(i).createElement(qe.TooltipText,null,p("notificationTransactionApprovalSolanaAmountRequired")))}),p("notificationTransactionApprovalNetworkFee")),e(i).createElement(z.Text,{size:14,weight:500,lineHeight:17,whiteSpace:"normal",wordBreak:"break-word"},e(i).createElement(ot.SolBalance,null,m))))),e(i).createElement(z.Text,{size:14,lineHeight:19,color:"#777777",margin:"17px 0",onClick:()=>f(!g)},p(g?"notificationTransactionApprovalHideAdvancedDetails":"notificationTransactionApprovalViewAdvancedDetails")),g&&e(i).createElement(Oe.TransactionInstructionRows,{messages:a}))),e(i).createElement(j.Footer,null,e(i).createElement(K.ButtonPair,{primaryText:p("notificationTransactionApprovalActionButtonApprove"),secondaryText:p("notificationTransactionApprovalActionButtonCancel"),onPrimaryClicked:o,onSecondaryClicked:r})))};var dt=r("djb9u");j=r("bJYWD"),i=r("aZikt"),q=r("hHMPk"),L=r("7Qmuu"),D=r("cFuyE"),W=r("9AO5f"),U=r("lSpdH"),K=r("aADTv"),z=r("g7X40"),j=r("bJYWD");const pt=q.default.div`
  width: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
`,mt=q.default.div`
  border: 1px solid ${"#eb3742"};
  border-radius: 8px;
  padding: 10px 10px;
  margin-bottom: 10px;
`,gt=({tabId:t,origin:n,proceedToApproval:a,denyApproval:o})=>{const{t:r}=L.useTranslation();return e(i).createElement(j.Container,null,e(i).createElement(W.AccountHeader,{lastChild:e(i).createElement("div",null),walletMenuShowOnlyAccounts:!0}),e(i).createElement(j.Body,null,e(i).createElement(j.TopGroup,null,e(i).createElement(U.TabIconHeader,{tabId:t,secondaryText:D.removeWebPrefixes(n),showWarning:!0})),e(i).createElement(pt,null,e(i).createElement(mt,null,e(i).createElement(z.Text,{size:14,color:"#eb3742"},r("maliciousTransactionWarning"))),e(i).createElement(z.Text,{size:14,color:"#777777",hoverColor:"#eb3742",onClick:()=>a(n)},r("maliciousTransactionWarningIgnoreWarning")))),e(i).createElement(j.Footer,{plain:!0},e(i).createElement(K.Button,{onClick:()=>o(n)},r("maliciousTransactionWarningButtonClose"))))};Y=r("lPkGw");var ft=r("fRhfQ"),vt=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{l(a.next(e))}catch(e){r(e)}}function s(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((a=a.apply(e,t||[])).next())}))};const yt=q.default.div`
  display: flex;
  flex-direction: column;
  height: 100%;
  justify-content: center;
  align-items: center;
`,ht=({origin:t,requestId:n,requestMethod:a,tabId:o,unsignedTransactionMessages:r=[],unsignedTransactions:s=[],signAndSendSignatures:u=[],options:d={}})=>{var p;const{t:m}=L.useTranslation(),[f,v]=i.useState(!1),[y]=ft.useFeatureFlags(["tx-submission-service"]),h=w.useTransactionsManager(),T=g.usePostOutgoingBackgroundResponse(),{accountClient:E,accountMeta:A}=S.useSelectedSolanaAccount(),b=A.type===H.AccountType.Ledger,x=a===l.ProviderToWalletRequestMethods.SignTransaction,C=a===l.ProviderToWalletRequestMethods.SignAllTransactions,M=a===l.ProviderToWalletRequestMethods.SignAndSendTransaction,P=null===(p=de.useFetchConnection())||void 0===p?void 0:p.data,R=null==P?void 0:P.connection,{pushDetailView:I,popDetailView:O}=k.useDetailViews(),B=c.canEvadeTransactionSimulation(r);let q=E;const D=q.publicKey.toString(),{isTxnKnownMalicious:N,isTxnSuspectedMalicious:W,isLoading:K}=((e,t)=>{const n=ae.getOrigin(t)||"",a=re.useFetchScannedTransaction(e,n);return i.useEffect((()=>{null!==a.error&&a.error===ie.ERR_REQUEST_TIMEOUT_REACHED?F.analytics.capture("scanTransactionRequestTimeoutReached",{data:{origin:n}}):null!==a.error&&F.analytics.capture("scanTransactionRequestError",{data:{origin:n,error:a.error.message}})}),[a,n]),a})(s,t),U=i.useCallback((a=>vt(void 0,void 0,void 0,(function*(){let o;if(b){if(!R)return;const e=oe.createSignerFromLedgerAccountMeta(A,a);q=new ne.AccountClient(R,e,y,h)}try{if(M){const e=c.messageAndSignaturesToTransaction(r[0],u),a=yield q.signAndSendTransactionAsync(e,d);F.analytics.capture("signAndSendTransaction",{data:{origin:t}}),o=l.createSignSuccessResponse(n,a,D)}else{const e=[];for(const t of r)e.push(yield q.signMessageAsync(t));x?(F.analytics.capture("signTransaction",{data:{origin:t}}),o=l.createSignSuccessResponse(n,e[0],D)):C&&(F.analytics.capture("signAllTransactions",{data:{origin:t}}),o=l.createSignAllTransactionsSuccessResponse(n,e,D))}F.analytics.capture("transactionConfirm",{data:{origin:ae.getOrigin(t),canEvadeSimulation:B}}),T(o)}catch(t){console.error(t),dt.isKnownLedgerActionError(t)?I(e(i).createElement(j.LedgerWrapper,null,e(i).createElement(dt.LedgerActionError,{ledgerActionError:t,onRetryClick:()=>{O()},onCancelClick:()=>{o=l.createJsonRpcErrorResponse(n,l.RpcErrorCode.UserRejectedRequest),T(o)}}))):b?(o=l.createJsonRpcErrorResponse(n,l.RpcErrorCode.UserRejectedRequest),T(o)):(o=l.createJsonRpcErrorResponse(n,l.RpcErrorCode.TransactionRejected,null==t?void 0:t.message),T(o))}}))),[n,r,E,R,T,t,B]),z=i.useCallback((()=>{b?I(e(i).createElement(j.LedgerWrapper,null,e(i).createElement(dt.LedgerAction,{ledgerAction:U,cancel:Q})),{shouldShowBackButton:!1}):U()}),[U,s,t,D,B]),$=i.useCallback((()=>{F.analytics.capture("userIgnoredKnownMaliciousWarning",{data:{origin:ae.getOrigin(t)}}),v(!0)}),[t]),Q=i.useCallback((()=>{const e=l.createJsonRpcErrorResponse(n,l.RpcErrorCode.UserRejectedRequest);F.analytics.capture("transactionDeny",{data:{origin:ae.getOrigin(t),canEvadeSimulation:B}}),T(e)}),[n,T,t,B]);return K?e(i).createElement(yt,null,e(i).createElement(Y.Spinner,null)):N&&!f?e(i).createElement(gt,{tabId:o,origin:t,proceedToApproval:$,denyApproval:Q}):e(i).createElement(ut,{tabId:o,origin:t,messages:r,confirmApproval:z,denyApproval:Q,transactionName:m("notificationSignatureRequestApproveTransactionCapitalized"),isTxnKnownMalicious:N,isTxnSuspectedMalicious:W})};var Tt={};t(Tt,"SignMessageRequest",(function(){return bt}),(function(e){return bt=e}));i=r("aZikt"),F=r("8C6BZ"),l=r("eLyRJ"),H=r("lwple"),D=r("cFuyE"),S=r("82Ilk"),k=r("6rMcH"),de=r("fMhDQ"),dt=r("djb9u"),K=r("aADTv"),W=r("9AO5f"),j=r("bJYWD"),U=r("lSpdH");var Et=r("dkOkP").Buffer,At=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{l(a.next(e))}catch(e){r(e)}}function s(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((a=a.apply(e,t||[])).next())}))};const bt=t=>{var n;const{origin:a,requestId:o,message:r,display:s,tabId:c}=t,u=g.usePostOutgoingBackgroundResponse(),{accountClient:d,accountMeta:p}=S.useSelectedSolanaAccount(),m=null===(n=de.useFetchConnection())||void 0===n?void 0:n.data,f=null==m?void 0:m.connection,{pushDetailView:v}=k.useDetailViews(),y=i.useCallback((()=>At(void 0,void 0,void 0,(function*(){const e=d;try{const t=yield e.signUTF8(Et.from(r).toString()),n=e.publicKey.toString(),i=l.createSignSuccessResponse(o,t,n);F.analytics.capture("signMessageConfirm",{data:{origin:a}}),u(i)}catch(e){T()}}))),[o,r,d,f,u]),h=i.useCallback((()=>{p.type===H.AccountType.Ledger?v(e(i).createElement(j.LedgerWrapper,null,e(i).createElement(dt.LedgerAction,{ledgerAction:y,cancel:T})),{shouldShowBackButton:!1}):y()}),[y]),T=i.useCallback((()=>{const e=l.createJsonRpcErrorResponse(o,l.RpcErrorCode.UserRejectedRequest);F.analytics.capture("transactionDeny",{data:{origin:a}}),u(e)}),[o,u]);return e(i).createElement(j.Container,null,e(i).createElement(W.AccountHeader,{firstChild:e(i).createElement("div",null),lastChild:e(i).createElement("div",null)}),e(i).createElement(j.Body,null,e(i).createElement(j.Icon,null,e(i).createElement(U.TabIconHeader,{tabId:c,primaryText:"Signature Request",secondaryText:D.removeWebPrefixes(a)})),e(i).createElement(Oe.SignMessageInstructionRow,{message:r,display:s})),e(i).createElement(j.Footer,null,e(i).createElement(K.ButtonPair,{primaryText:"Approve",secondaryText:"Cancel",onPrimaryClicked:h,onSecondaryClicked:T})))};var xt=r("i2Zy4"),kt=r("jd2rl"),St=r("3JoTt");u.initSentry();const wt=()=>{const t=g.useIncomingBackgroundRequest();if(!t)return null;const{origin:n,req:a,tabId:o}=t,{id:r,method:s}=a,{message:u,messages:d,transaction:p,transactions:m,display:f,options:v}=a.params,y=p?c.transactionStringToMessageString(p):u,h=m?m.map((e=>c.transactionStringToMessageString(e))):d,T=s===l.ProviderToWalletRequestMethods.Connect,E=s===l.ProviderToWalletRequestMethods.SignMessage,A=s===l.ProviderToWalletRequestMethods.SignTransaction,b=s===l.ProviderToWalletRequestMethods.SignAllTransactions,x=s===l.ProviderToWalletRequestMethods.SignAndSendTransaction,S=A||b,w=y instanceof Uint8Array?y:l.objectToUint8Array(null!=y?y:{}),C=A||x?[y]:b?h:void 0,M=A||x?[u?c.messageStringToTransactionString(u):p]:b?d?d.map((e=>c.messageStringToTransactionString(e))):m:void 0,P=x&&p?c.transactionStringToTransaction(p,"bs58").signatures:void 0,R=T?"Connection Error":"Transaction Error",I=`There was an error attempting to ${T?"connect to the application":"sign the transaction"}. Please try again.`;return St.useRootGroupEffect(),St.useCaptureOpen("notificationOpen",{data:{method:s}}),e(i).createElement(xt.PopupAndNotificationErrorBoundary,{title:R,message:I},T?e(i).createElement(ee,{tabId:o,origin:n,requestId:r}):E?e(i).createElement(k.DetailViewsProvider,null,e(i).createElement(Tt.SignMessageRequest,{tabId:o,origin:n,requestId:r,message:w,display:f})):S?e(i).createElement(k.DetailViewsProvider,null,e(i).createElement(te.SignatureRequest,{tabId:o,origin:n,requestId:r,requestMethod:s,unsignedTransactionMessages:C,unsignedTransactions:M})):x?e(i).createElement(k.DetailViewsProvider,null,e(i).createElement(te.SignatureRequest,{tabId:o,origin:n,requestId:r,requestMethod:s,unsignedTransactionMessages:C,unsignedTransactions:M,signAndSendSignatures:P,options:v})):null)},Ct=()=>{const t=i.useCallback((t=>e(i).createElement(P.ModalsProvider,null,e(i).createElement(M.WalletMenuProvider,null,e(i).createElement(O.Unlock,{onUnlock:t})))),[]),n=i.useCallback((()=>{p.openTabAsync({url:"onboarding.html"}),window.close()}),[]);return e(i).createElement(e(i).Fragment,null,e(i).createElement(d.ThemedGlobalStyle,{backgroundColor:"#222222"}),e(i).createElement(xt.PopupAndNotificationErrorBoundary,null,e(i).createElement(I.Main,null,e(i).createElement(R.QueryProvider,null,e(i).createElement(g.BackgroundConnectionProvider,null,e(i).createElement(kt.ExtensionLockWrapper,{renderLocked:t,openOnboarding:n},e(i).createElement(w.TransactionsProvider,null,e(i).createElement(C.HardwareWalletProvider,null,e(i).createElement(S.SolanaAccountsProvider,null,e(i).createElement(M.WalletMenuProvider,null,e(i).createElement(wt,null)))))))),e(i).createElement("div",{id:m.MODAL_ID}))))};s.render(e(i).createElement(Ct,null),document.getElementById("root"));define=__define;})(window.define);